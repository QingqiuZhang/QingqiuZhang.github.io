<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
<title>
    Qingqiu Zhang
</title>
<!--[if lt IE 9]><script src="//cdn.bootcss.com/html5shiv/r29/html5.js"></script><![endif]-->
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
<meta name="author" content="Qingqiu Zhang">
<meta name="description" content="Thank you for visiting. Have fun here!">
<meta name="keywords" content="">
<script async src="//instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
<link rel="stylesheet" href="https://qingqiuzhang.github.io/styles/main.css" />
<link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/1.7.1/jquery.min.js"></script>

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/css/style.min.css" />
        <script src="https://cdn.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/tocbot.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/script.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/icon.min.js"></script>
        
            <script src="https://cdn.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/js/Card/prism.min.js"></script>
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/css/Card/prism.min.css" />
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css">
            <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js"></script>
            
                            <script>
                                (function() {
                                    var bp = document.createElement('script');
                                    var curProtocol = window.location.protocol.split(':')[0];
                                    if (curProtocol === 'https') {
                                        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
                                    } else {
                                        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                                    }
                                    var s = document.getElementsByTagName("script")[0];
                                    s.parentNode.insertBefore(bp, s);
                                })();
                            </script>
                            
                                <script async src="https://www.googletagmanager.com/gtag/js?id=UA-224309801-1"></script>
                                <script>
                                    window.dataLayer = window.dataLayer || [];

                                    function gtag() {
                                        dataLayer.push(arguments);
                                    }
                                    gtag('js', new Date());
                                    gtag('config', 'UA-224309801-1');
                                </script>
                                
</head>

<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo">
                <a href="https://qingqiuzhang.github.io">
                    Qingqiu Zhang
                </a>
            </div>
            <div id="tp-weather-widget"></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/">
                        Home
                    </a>
                    
                    <a class="menu-item" href="https://qingqiuzhang.github.io/content">
                        Content
                    </a>
                    
                    <a class="menu-item" href="/tags">
                        Tag
                    </a>
                    
                    <a class="menu-item" href="https://qingqiuzhang.github.io/about-me">
                        About Me
                    </a>
                    
                        <input id="switch_default" type="checkbox" class="switch_default">
                        <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
        <nav class="navbar-mobile" id="nav-mobile">
            <div class="container">
                <div class="navbar-header">
                    <div>
                        <a href="https://qingqiuzhang.github.io">
                            Qingqiu Zhang
                        </a>
                        <!--en-->
                        <a id="mobile-toggle-theme-en" class="a en">&nbsp;Dark</a>
                        <!--zh-->
                        <a id="mobile-toggle-theme-zh" class="a zh">&nbsp;&#x6697;&#x9ED1;</a>
                    </div>
                    <form id="gridea-search-form" data-update="1648959663487" action="/search/index.html">
                        <input class="search-input" autocomplete="off" spellcheck="false" name="q" autofocus="true" placeholder="Search...">
                    </form>
                    <!--en-->
                    <div class="menu-toggle" id="menu-toggle-en" onclick="mobileBtn()">&#9776; Menu</div>
                    <!--zh-->
                    <div class="menu-toggle" id="menu-toggle-zh" onclick="mobileBtn()">&#9776; &#x83DC;&#x5355;</div>

                </div>
                <div class="menu" id="mobile-menu">
                    
                        <a class="menu-item" href="/">
                            Home
                        </a>
                        
                        <a class="menu-item" href="https://qingqiuzhang.github.io/content">
                            Content
                        </a>
                        
                        <a class="menu-item" href="/tags">
                            Tag
                        </a>
                        
                        <a class="menu-item" href="https://qingqiuzhang.github.io/about-me">
                            About Me
                        </a>
                        
                </div>
            </div>
        </nav>
</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementById("menu-toggle-en");
        var toggleMenu_zh = document.getElementById("menu-toggle-zh");

        var mobileMenu = document.getElementById("mobile-menu");
        if (toggleMenu.display != "none") {
            if (toggleMenu.classList.contains("active")) {
                toggleMenu.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu.classList.add("active")
                mobileMenu.classList.add("active")
            }
        } else if (toggleMenu_zh.display != "none") {
            if (toggleMenu_zh.classList.contains("active")) {
                toggleMenu_zh.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu_zh.classList.add("active")
                mobileMenu.classList.add("active")
            }
        }

    }
</script>

            <div class="main">
                <div class="container">
                    <article class="post-wrap">
                        <header class="post-header">
                            <h1 class="post-title">
                                Diabetes Data Analytics (1) -- Data Preprocessing
                            </h1>
                            
                                <!--en-->
                                <div class="post-meta en">
                                    Author:
                                    <a itemprop="author" rel="author" href="/">
                                        Qingqiu Zhang
                                    </a>
                                    <span class="post-time">
                                Date: <a href="#">2022-02-19</a>
                            </span>
                                    
                                        <span class="post-category">
                                Category:
                                
                                <a href="https://qingqiuzhang.github.io/WOUmPg0ZPX/">Python</a>
                                
                                <a href="https://qingqiuzhang.github.io/2uMVT4cFu/">Classification</a>
                                
                                <a href="https://qingqiuzhang.github.io/URtsfZ1k8/">Machine Learning</a>
                                
                            </span>
                                        
                                </div>
                                
                        </header>
                        
                        <div class="post-content">
                            <p>This is a thorough analysis of diabetes dataset from Kaggle. In this article, I will demonstrate how to an end-to-end machine learning project using diverse classification models.</p>
<!-- more -->
<p><strong>In case you need the source data, visit this webpage:</strong> <a href="https://www.kaggle.com/datasets/mathchi/diabetes-data-set">Data Source</a></p>
<h1 id="what-can-we-do-with-this-dataset">What Can We Do With This Dataset?</h1>
<p>The observations in the dataset are all females from Pima Indian heritage who are greater than or equal to 21 years old.</p>
<h1 id="data-preprocessing">Data Preprocessing</h1>
<p>I cannot emphasize the importance of data preprocessing. It is the process of transforming raw data into more reasonable, useful and efficient format. It's a must and one of the most important step in a machine learing project. Without it our models will probably crash and won't be able to generate good results.<br>
There are several steps in data preprocessing: data cleaning, data reduction and data transformation. In the following paragraphs, I'll show you how to perform the steps one by one.</p>
<h2 id="data-cleaning">Data Cleaning</h2>
<pre><code class="language-Python3"># packages needed
import numpy as np
import pandas as pd

# load data
data = pd.read_csv('diabetes.csv')
data.head(10)
</code></pre>
<table border="1" style="font-size:67%;">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pregnancies</th>
      <th>Glucose</th>
      <th>BloodPressure</th>
      <th>SkinThickness</th>
      <th>Insulin</th>
      <th>BMI</th>
      <th>DiabetesPedigreeFunction</th>
      <th>Age</th>
      <th>Outcome</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6</td>
      <td>148</td>
      <td>72</td>
      <td>35</td>
      <td>0</td>
      <td>33.6</td>
      <td>0.627</td>
      <td>50</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>85</td>
      <td>66</td>
      <td>29</td>
      <td>0</td>
      <td>26.6</td>
      <td>0.351</td>
      <td>31</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>183</td>
      <td>64</td>
      <td>0</td>
      <td>0</td>
      <td>23.3</td>
      <td>0.672</td>
      <td>32</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>89</td>
      <td>66</td>
      <td>23</td>
      <td>94</td>
      <td>28.1</td>
      <td>0.167</td>
      <td>21</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>137</td>
      <td>40</td>
      <td>35</td>
      <td>168</td>
      <td>43.1</td>
      <td>2.288</td>
      <td>33</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>116</td>
      <td>74</td>
      <td>0</td>
      <td>0</td>
      <td>25.6</td>
      <td>0.201</td>
      <td>30</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>3</td>
      <td>78</td>
      <td>50</td>
      <td>32</td>
      <td>88</td>
      <td>31.0</td>
      <td>0.248</td>
      <td>26</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>10</td>
      <td>115</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>35.3</td>
      <td>0.134</td>
      <td>29</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2</td>
      <td>197</td>
      <td>70</td>
      <td>45</td>
      <td>543</td>
      <td>30.5</td>
      <td>0.158</td>
      <td>53</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>8</td>
      <td>125</td>
      <td>96</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.232</td>
      <td>54</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>The meaning of each column is stated as below:</p>
<blockquote>
<ul>
<li>Pregnancies: Number of times pregnant</li>
<li>Glucose: Plasma glucose concentration a 2 hours in an oral glucose tolerance test</li>
<li>BloodPressure: Diastolic blood pressure (mm Hg)</li>
<li>SkinThickness: Triceps skin fold thickness (mm)</li>
<li>Insulin: 2-Hour serum insulin (mu U/ml)</li>
<li>BMI: Body mass index (weight in kg/(height in m)^2)</li>
<li>DiabetesPedigreeFunction: Diabetes pedigree function</li>
<li>Age: Age (years)</li>
<li>Outcome: Class variable (0 or 1)</li>
</ul>
</blockquote>
<p>Next, we need to examin whether there are null values in the dataset.</p>
<pre><code class="language-Python3">data.isnull().sum()
</code></pre>
<pre>Pregnancies                 0
Glucose                     0
BloodPressure               0
SkinThickness               0
Insulin                     0
BMI                         0
DiabetesPedigreeFunction    0
Age                         0
Outcome                     0
dtype: int64</pre>
<p>It seems there is no null values. Shall we pop the champagne now? If we further examine the data, we will find that the situation is not as good as we thought.</p>
<pre><code class="language-Python">data.describe().round(2)
</code></pre>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Pregnancies</th>
      <td>768.0</td>
      <td>3.85</td>
      <td>3.37</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>3.00</td>
      <td>6.00</td>
      <td>17.00</td>
    </tr>
    <tr>
      <th>Glucose</th>
      <td>768.0</td>
      <td>120.89</td>
      <td>31.97</td>
      <td>0.00</td>
      <td>99.00</td>
      <td>117.00</td>
      <td>140.25</td>
      <td>199.00</td>
    </tr>
    <tr>
      <th>BloodPressure</th>
      <td>768.0</td>
      <td>69.11</td>
      <td>19.36</td>
      <td>0.00</td>
      <td>62.00</td>
      <td>72.00</td>
      <td>80.00</td>
      <td>122.00</td>
    </tr>
    <tr>
      <th>SkinThickness</th>
      <td>768.0</td>
      <td>20.54</td>
      <td>15.95</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>23.00</td>
      <td>32.00</td>
      <td>99.00</td>
    </tr>
    <tr>
      <th>Insulin</th>
      <td>768.0</td>
      <td>79.80</td>
      <td>115.24</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>30.50</td>
      <td>127.25</td>
      <td>846.00</td>
    </tr>
    <tr>
      <th>BMI</th>
      <td>768.0</td>
      <td>31.99</td>
      <td>7.88</td>
      <td>0.00</td>
      <td>27.30</td>
      <td>32.00</td>
      <td>36.60</td>
      <td>67.10</td>
    </tr>
    <tr>
      <th>DiabetesPedigreeFunction</th>
      <td>768.0</td>
      <td>0.47</td>
      <td>0.33</td>
      <td>0.08</td>
      <td>0.24</td>
      <td>0.37</td>
      <td>0.63</td>
      <td>2.42</td>
    </tr>
    <tr>
      <th>Age</th>
      <td>768.0</td>
      <td>33.24</td>
      <td>11.76</td>
      <td>21.00</td>
      <td>24.00</td>
      <td>29.00</td>
      <td>41.00</td>
      <td>81.00</td>
    </tr>
    <tr>
      <th>Outcome</th>
      <td>768.0</td>
      <td>0.35</td>
      <td>0.48</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>
<p>We can see from the picture above that the minimum value of Glucose, BloodPressure, SkinThickness, Insulin, BMI is zero. However, anyone having common sense knows that by no means would these indicators of an alive person be zero. Apparently, the null values are replaced by zeros when inputing data. Here we calculate the number of null values in each column so that we will better decide how to deal with them.</p>
<pre><code class="language-Python3">for col in list(data.columns):
    zero = len(data[data[col] == 0])
    print('0s in %s: %d' % (col, zero))
</code></pre>
<pre>0s in Pregnancies: 111
0s in Glucose: 5
0s in BloodPressure: 35
0s in SkinThickness: 227
0s in Insulin: 374
0s in BMI: 11
0s in DiabetesPedigreeFunction: 0
0s in Age: 0
0s in Outcome: 500
</pre>
<p>There are nearly 400 null values in Insulin column, so it's not realistic to drop all the null values. Normally under such circumstance, we replace them with indicators such as mean, median, or mode, etc. Here I choose median.</p>
<pre><code class="language-Python3"># replace 0s in target columns with null value
data.iloc[:, 1:6] = data.iloc[:, 1:6].replace({0:np.NaN})
# fill null values with medians
data = data.fillna(data.median()) 
data.describe().round(2).T
</code></pre>
<table border="1">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Pregnancies</th>
      <td>768.0</td>
      <td>3.85</td>
      <td>3.37</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>3.00</td>
      <td>6.00</td>
      <td>17.00</td>
    </tr>
    <tr>
      <th>Glucose</th>
      <td>768.0</td>
      <td>121.66</td>
      <td>30.44</td>
      <td>44.00</td>
      <td>99.75</td>
      <td>117.00</td>
      <td>140.25</td>
      <td>199.00</td>
    </tr>
    <tr>
      <th>BloodPressure</th>
      <td>768.0</td>
      <td>72.39</td>
      <td>12.10</td>
      <td>24.00</td>
      <td>64.00</td>
      <td>72.00</td>
      <td>80.00</td>
      <td>122.00</td>
    </tr>
    <tr>
      <th>SkinThickness</th>
      <td>768.0</td>
      <td>29.11</td>
      <td>8.79</td>
      <td>7.00</td>
      <td>25.00</td>
      <td>29.00</td>
      <td>32.00</td>
      <td>99.00</td>
    </tr>
    <tr>
      <th>Insulin</th>
      <td>768.0</td>
      <td>140.67</td>
      <td>86.38</td>
      <td>14.00</td>
      <td>121.50</td>
      <td>125.00</td>
      <td>127.25</td>
      <td>846.00</td>
    </tr>
    <tr>
      <th>BMI</th>
      <td>768.0</td>
      <td>32.46</td>
      <td>6.88</td>
      <td>18.20</td>
      <td>27.50</td>
      <td>32.30</td>
      <td>36.60</td>
      <td>67.10</td>
    </tr>
    <tr>
      <th>DiabetesPedigreeFunction</th>
      <td>768.0</td>
      <td>0.47</td>
      <td>0.33</td>
      <td>0.08</td>
      <td>0.24</td>
      <td>0.37</td>
      <td>0.63</td>
      <td>2.42</td>
    </tr>
    <tr>
      <th>Age</th>
      <td>768.0</td>
      <td>33.24</td>
      <td>11.76</td>
      <td>21.00</td>
      <td>24.00</td>
      <td>29.00</td>
      <td>41.00</td>
      <td>81.00</td>
    </tr>
    <tr>
      <th>Outcome</th>
      <td>768.0</td>
      <td>0.35</td>
      <td>0.48</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>
Now we can visualize the dataset and see if we can find something else.
<pre><code class="language-Python3">import seaborn as sns
sns.pairplot(data, hue=&quot;Outcome&quot;, corner=True)
</code></pre>
<p><img src="https://qingqiuzhang.github.io/post-images/1648690175972.png" alt="Pairplot-Imbalanced data set" loading="lazy"><br>
From the pairplot above, we discover this is an imbalanced dataset. There are 500 observations whose outcome is 0 and only 268 is 1. If we train our model with such data, the results may be misleading. There are several methods to deal with imbalanced data:</p>
<ol>
<li>Collect more data</li>
<li>Under-Sampling</li>
<li>Over-Sampling</li>
<li>Use confusion matrix or other way to evaluate the peformance<br>
As the number of observations is only 768, it's unrealistic to under-sampling. Here I wil illustrate how to do oversampling using SMOTE().</li>
</ol>
<pre><code class="language-Python3">from imblearn.over_sampling import SMOTE 
# get X, y
X = data.iloc[:, 0:8]
y = data.iloc[:, -1]
# perform SMOTE()
oversample = SMOTE()
X, y = oversample.fit_resample(X, y)
# join X, y
y = pd.DataFrame(y)
data = pd.concat([X, y], axis=1)
print(data.shape)
data.describe().round(2).T
</code></pre>
<table border="1">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Pregnancies</th>
      <td>1000.0</td>
      <td>3.99</td>
      <td>3.33</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>3.00</td>
      <td>6.00</td>
      <td>17.00</td>
    </tr>
    <tr>
      <th>Glucose</th>
      <td>1000.0</td>
      <td>126.40</td>
      <td>31.39</td>
      <td>44.00</td>
      <td>102.82</td>
      <td>122.00</td>
      <td>148.00</td>
      <td>199.00</td>
    </tr>
    <tr>
      <th>BloodPressure</th>
      <td>1000.0</td>
      <td>72.97</td>
      <td>11.71</td>
      <td>24.00</td>
      <td>65.75</td>
      <td>72.00</td>
      <td>80.00</td>
      <td>122.00</td>
    </tr>
    <tr>
      <th>SkinThickness</th>
      <td>1000.0</td>
      <td>29.64</td>
      <td>8.22</td>
      <td>7.00</td>
      <td>27.00</td>
      <td>29.00</td>
      <td>33.00</td>
      <td>99.00</td>
    </tr>
    <tr>
      <th>Insulin</th>
      <td>1000.0</td>
      <td>146.58</td>
      <td>90.69</td>
      <td>14.00</td>
      <td>125.00</td>
      <td>125.00</td>
      <td>136.25</td>
      <td>846.00</td>
    </tr>
    <tr>
      <th>BMI</th>
      <td>1000.0</td>
      <td>33.01</td>
      <td>6.68</td>
      <td>18.20</td>
      <td>28.40</td>
      <td>32.66</td>
      <td>36.80</td>
      <td>67.10</td>
    </tr>
    <tr>
      <th>DiabetesPedigreeFunction</th>
      <td>1000.0</td>
      <td>0.49</td>
      <td>0.32</td>
      <td>0.08</td>
      <td>0.26</td>
      <td>0.40</td>
      <td>0.65</td>
      <td>2.42</td>
    </tr>
    <tr>
      <th>Age</th>
      <td>1000.0</td>
      <td>33.88</td>
      <td>11.34</td>
      <td>21.00</td>
      <td>25.00</td>
      <td>31.00</td>
      <td>41.00</td>
      <td>81.00</td>
    </tr>
    <tr>
      <th>Outcome</th>
      <td>1000.0</td>
      <td>0.50</td>
      <td>0.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.50</td>
      <td>1.00</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>
Once again visualize the dataset to see the changes in the distribution of data.
<pre><code class="language-Python3">sns.pairplot(data, hue=&quot;Outcome&quot;, corner=True)
</code></pre>
<p><img src="https://qingqiuzhang.github.io/post-images/1648950949751.png" alt="pairplot2" loading="lazy"><br>
For now, we transform the original imbalanced dataset into a balanced dataset with the number of each outcome class being 500. there is not much difference in distribution between diabetics and nondiabetics. Glucose should have the highest correlation with Outcome among all the features. We can testify it using a correlation matrix heatmap.</p>
<pre><code class="language-Python3">corr_mat = data.corr().round(2)
plt.figure(figsize = (15,10))
sns.heatmap(corr_mat, annot=True)
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://qingqiuzhang.github.io/post-images/1648951579451.png" alt="" loading="lazy"></figure>
<h2 id="data-transformation">Data Transformation</h2>
<p>If the range of two features differ a lot, for example, one is from 0 to 1 and the other is from 0 to 10,000, apparantly models won't treat such two features equally. Normally, the feature with larger range would influence the result more. Nevertheless, this doesn't mean it's more important than the other one. That's why we need scale the features. Frequently used scaling techniques are:</p>
<ul>
<li>MinMaxScaler()</li>
<li>StardardScaler()</li>
<li>MaxAbsScaler()</li>
<li>RobustScaler()</li>
</ul>
<p>I usually choose MinMaxScaler() or StandardScaler() for most of datasets. You can also use others according to the charasteristic of the dataset at hand.</p>
<pre><code class="language-Python3"># get X, y
X = data.drop([&quot;Outcome&quot;], axis=1)
y = data[&quot;Outcome&quot;]

X2 = X.copy
y2 = y.copy

from sklearn.model_selection import train_test_split
# split X, y into traning set and validation set
X2_train, X2_trainValid, y2_train, y2_trainValid = train_test_split(X, y, test_size=0.5, stratify=y)
# perform feature scaling
scaler = StandardScaler()
X2_train = scaler.fit_transform(X2_train)
print(X2_train)
X2_trainValid = scaler.transform(X2_trainValid)
print(X2_trainValid)
</code></pre>
<pre>[[-0.86583338 -1.18590252 -2.5407598  ...  2.36236055  0.059368
  -0.66182567]
 [-0.56074762 -1.30437961 -0.5856297  ...  0.92385297  1.5766631
  -0.575063  ]
 [-0.56074762 -0.84741167 -1.01001675 ...  0.49700038 -0.09947556
  -1.09563904]
 ...
 [ 0.35450965  0.45821104  0.68753147 ... -0.21442061 -0.42275597
  -0.74858835]
 [ 1.57485267  1.18460674 -0.30940607 ... -1.09502236 -0.52771647
   1.07342779]
 [-0.56074762 -0.8147711  -0.33099746 ...  0.76734036 -0.55277092
  -0.66182567]]
[[ 1.57485267 -0.73832382  1.59549311 ...  1.66775686  1.24296528
   0.55285175]
 [-0.86583338 -1.43494188  0.17826701 ...  1.8771571   2.15997341
  -0.14124963]
 [-0.86583338  2.09023942 -1.01001675 ... -0.4278469  -0.29274103
   2.20134255]
 ...
 [-0.86583338 -1.50022302  0.68753147 ... -1.09658263  0.35733372
  -1.00887637]
 [-1.17091913 -0.03139747 -0.16124264 ... -0.81201424 -0.79874515
   0.20580106]
 [-1.17091913 -1.66342586 -1.68903605 ... -0.75510056 -0.74603639
  -1.00887637]]
</pre>
<h2 id="data-reduction">Data Reduction</h2>
<p>With clean data at hand, we can visulize the data, which may indicate some relations between the features or between features and targets. Knowing these is useful to data reduction, for example, if a feature is highly correlated with the target, then we had better retain it. Or if two features are highly correlated, it would be much easier for us if we drop out one of them. Here I use PCA (Principal componenet analysis) for a demonstration.</p>
<pre><code class="language-Python3">from sklearn.decomposition import PCA
pca = PCA()
X = pca.fit_transform(X)
print(X)
</code></pre>
<pre>[[-1.48212827e+01  2.66418913e+01  6.77045733e+00 ...  1.28306645e+00
  -4.41730071e-01  1.08702215e-01]
 [-2.53614440e+01 -3.80054541e+01 -1.53466357e+00 ...  4.06783776e+00
  -2.50459441e+00 -9.57021831e-02]
 [-9.83659118e+00  5.72071616e+01 -1.78166537e+01 ...  8.30157785e+00
   4.60163646e+00  2.42241723e-01]
 ...
 [-8.54656132e+01  3.00921079e+01  6.86126007e+00 ...  4.57134748e+00
   2.42255141e+00  1.22062151e-01]
 [-2.36693301e+01 -2.79343649e+01 -3.54949033e+00 ... -3.82012635e-01
   4.69302230e-01 -2.89569829e-01]
 [-1.69091697e+01  1.34152393e+01  3.35830801e+00 ... -1.66109447e+01
   5.12758994e+00  2.13862262e-02]]
</pre>

                        </div>
                        
                            <div class="post-toc">
                                <ul class="markdownIt-TOC">
<li><a href="#what-can-we-do-with-this-dataset">What Can We Do With This Dataset?</a></li>
<li><a href="#data-preprocessing">Data Preprocessing</a>
<ul>
<li><a href="#data-cleaning">Data Cleaning</a></li>
<li><a href="#data-transformation">Data Transformation</a></li>
<li><a href="#data-reduction">Data Reduction</a></li>
</ul>
</li>
</ul>

                            </div>
                            
                                
                                                    
                                                                <!--en-->
                                                                <section class="post-tags en ">
                                                                    <div>
                                                                        <span>Tag(s):</span>
                                                                        <span class="tag ">
                        
                        
                        <a href="https://qingqiuzhang.github.io/WOUmPg0ZPX/">#
                                                Python
                                                    </a>
                                                    
                        <a href="https://qingqiuzhang.github.io/2uMVT4cFu/">#
                                                Classification
                                                    </a>
                                                    
                        <a href="https://qingqiuzhang.github.io/URtsfZ1k8/">#
                                                Machine Learning
                                                    </a>
                                                    
                                                        
                                                            </span>
                                                                    </div>
                                                                    <div>
                                                                        <a href="javascript:window.history.back();">back</a>
                                                                        <span>&dot;</span>
                                                                        <a href="#">home</a>
                                                                    </div>
                                                                </section>
                                                                
                                                                                <!---->
                                                                                <section class="post-nav">
                                                                                    
                                                                                            
                                                                                </section>
                    </article>
                </div>
                
                                            
            </div>
    </div>
    </div>
    </div>
    
        <footer id="footer" class="footer">
            <div class="copyright">
                
                        
                            
                                        <svg viewBox="0 0 1024 1024" style="margin-left: 5px;margin-right: 5px;" version="1.0" width="8" height="8" class="my-face">
            <path
                d="M863.597631 513.574282l-271.33965-140.213484L729.783667 81.926656c3.583731-7.87141 7.167462-15.742819 7.167462-25.214109C736.887134 25.226908 708.345275 0.012799 672.635953 0.012799a63.611229 63.611229 0 0 0-39.293053 12.607055c-1.791866 1.59988-3.519736 3.19976-5.311602 3.19976L147.87531 418.925381a55.547834 55.547834 0 0 0-19.646527 47.356448c1.791866 17.278704 14.27093 33.021523 32.125591 42.492813l271.33965 141.749369L292.504463 945.221908c-12.479064 25.214109-1.791866 53.563983 23.166262 69.306802 10.751194 6.335525 23.230258 9.47129 35.709322 9.47129 16.062795 0 32.125591-4.735645 44.604655-15.742819l480.091993-403.297753a55.547834 55.547834 0 0 0 19.646526-47.228458 61.243407 61.243407 0 0 0-32.12559-44.156688z"
                fill="#93b5cf"></path>
        </svg>
                                        Qingqiu Zhang &copy;Copyright
                                            <script>
                                                var date = new Date();
                                                document.write("" + date.getFullYear());
                                            </script>
                                            | Powered by
                                            <a href="https://coding.net" target="_blank">
                                                Coding.net
                                            </a>
            </div>
            <div id="update" style="display:none;">
                on
            </div>
            
                <div id="version" style="display:none;">
                    1.7.6
                </div>
                
                    <script>
                        var port = '';
                        
                        port = ':4000';
                        
                        document.write('<div id="home_path" style="display:none;">' + document.location.protocol + '//' + window.document.location.hostname + port + '</div>')
                    </script>
        </footer>
        
            <script src='https://cdn.jsdelivr.net/npm/live2d-widget@3.x/lib/L2Dwidget.min.js'></script>
            
                <script>
                    
                    
                    loadlive2d();
                    
                    
                    getStar();
                    hljs.initHighlighting();
                    console.clear();
                    
                    CheckVersion();
                    
                    var newDate = new Date();
                    newDate.setTime(1648959663487);
                    console.log(" Blog Update Time: " + newDate.toLocaleDateString());
                    console.log("\n %c \u26a1Theme:Chic Author's Blog:https://blog.itjoker.cn  Write By ITJoker  \n\n", "color: #ffffff; background: rgba(49, 49, 49, 0.85); padding:5px 0;border-radius:5px;");
                </script>
        </div>
</body>
<script>
    scroll();
</script>

</html>